# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (Matrix Factorization, SGD)

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ—Ü–µ–Ω–æ–∫ —Ñ–∏–ª—å–º–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ **–º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**, –æ–±—É—á–∞–µ–º–æ–π –º–µ—Ç–æ–¥–æ–º **—Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ (SGD)** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ early stopping**.

–í –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MovieLens (ratings.dat, movies.dat).

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç:
1. –ó–∞–≥—Ä—É–∑–∫—É –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞
2. –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ train / test –∏ baseline-–º–æ–¥–µ–ª–∏
3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
4. –û—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ (RMSE) –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
HW_var22/
‚îú‚îÄ‚îÄ CMakeLists.txt
‚îú‚îÄ‚îÄ include/
‚îÇ   ‚îú‚îÄ‚îÄ rating.h
‚îÇ   ‚îú‚îÄ‚îÄ dataset.h
‚îÇ   ‚îî‚îÄ‚îÄ mf_model.h
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.cpp
‚îÇ   ‚îú‚îÄ‚îÄ dataset.cpp
‚îÇ   ‚îî‚îÄ‚îÄ mf_model.cpp
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ ratings.dat
‚îÇ   ‚îî‚îÄ‚îÄ movies.dat
‚îú‚îÄ‚îÄ results/
‚îÇ   ‚îú‚îÄ‚îÄ dataset_stats.csv
‚îÇ   ‚îú‚îÄ‚îÄ baseline_rmse.csv
‚îÇ   ‚îú‚îÄ‚îÄ user_rating_counts.csv
‚îÇ   ‚îú‚îÄ‚îÄ movie_rating_counts.csv
‚îÇ   ‚îî‚îÄ‚îÄ mf_training_log.csv
‚îî‚îÄ‚îÄ README.md
```

---

## üìÑ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
- **CMakeLists.txt**
  –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ (C++17, —Å–±–æ—Ä–∫–∞ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ `app`).

---

### üìÅ include/

- **rating.h**
  –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

- **dataset.h**
  –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞, –ø–æ–¥—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ CSV.

- **mf_model.h**
  –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –∫–ª–∞—Å—Å–∞ –º–æ–¥–µ–ª–∏ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

---

### üìÅ src/

- **main.cpp**
  –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–±—É—á–µ–Ω–∏–µ, –æ—Ü–µ–Ω–∫–∞.

- **dataset.cpp**
  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏.

- **mf_model.cpp**
  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è SGD, early stopping –∏ RMSE.

---

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- `train_test_split(...)`
- baseline RMSE (–≥–ª–æ–±–∞–ª—å–Ω–æ–µ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ)
- `MFModel::fit_with_early_stopping(...)`
- `MFModel::evaluate(...)`
- `MFModel::save_training_log_csv(...)`

---

## ‚ñ∂Ô∏è –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
rm -rf build && cmake -B build && cmake --build build && ./build/app
```

---

## üìÅ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–í—Å–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ `results/`.

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é.
